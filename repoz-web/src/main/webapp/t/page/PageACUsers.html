<section class="windfury">

	<section class="main">
		<div class="acUserMain">
			<h1>Repository USers</h1>
			<table>
				<thead>
					<tr>
						<th>Path</th>
						<th>User</th>
						<th>Type</th>
						<th>Pass</th>
						<th>Actions</th>
					</tr>
				</thead>
				<tbody></tbody>
			</table>
		</div>
	</section>

	<script type="text/javascript">
		windfury.req([ 't/templ/base.html' ], function($, wf, base) {
			var main = wf.text('.main');

			function open() {
				var path = $.querystring().get('path');
				var page = $(main());
				base.open(page);

				function doDelete(user) {
					return function() {
						alert('delete: ' + user.user);
						return false;
					}
				}

				function showUsers(users) {
					var row = '<tr><td class="repo"/><td class="user"/><td class="type"/><td class="pass"/><td><button class="remove">Remove</button></td></tr>"';
					for (var i = 0; $.oplt(i, users.length); i++) {
						var user = users[i];
						var r = $(row);
						page.find('table tbody').append(r);
						r.find('.repo').text(user.repo);
						r.find('.user').text(user.user);
						r.find('.type').text(user.type);
						r.find('.pass').text(user.pass);
						r.find('.remove').click(doDelete(user));
					}
				}

				$.repoz.listRepoUsers(path, showUsers);
			}

			wf.def({
				open : open
			});
		});
	</script>

</section>